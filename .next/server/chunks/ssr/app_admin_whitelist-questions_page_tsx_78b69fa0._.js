module.exports=[35114,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(46271),e=a.i(62036),f=a.i(49741),g=a.i(49140),h=a.i(14512),i=a.i(13790),j=a.i(40695),k=a.i(5522),l=a.i(17171),m=a.i(54161),n=a.i(87682),o=a.i(46143),p=a.i(46893),q=a.i(97942),r=a.i(22262),s=a.i(97895);function t({...a}){return(0,b.jsx)(q.Root,{"data-slot":"sheet",...a})}function u({...a}){return(0,b.jsx)(q.Close,{"data-slot":"sheet-close",...a})}function v({...a}){return(0,b.jsx)(q.Portal,{"data-slot":"sheet-portal",...a})}function w({className:a,...c}){return(0,b.jsx)(q.Overlay,{"data-slot":"sheet-overlay",className:(0,s.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),...c})}function x({className:a,children:c,side:d="right",...e}){return(0,b.jsxs)(v,{children:[(0,b.jsx)(w,{}),(0,b.jsxs)(q.Content,{"data-slot":"sheet-content",className:(0,s.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500","right"===d&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm","left"===d&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm","top"===d&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b","bottom"===d&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",a),...e,children:[c,(0,b.jsxs)(q.Close,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[(0,b.jsx)(r.XIcon,{className:"size-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function y({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"sheet-header",className:(0,s.cn)("flex flex-col gap-1.5 p-4",a),...c})}function z({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"sheet-footer",className:(0,s.cn)("mt-auto flex flex-col gap-2 p-4",a),...c})}function A({className:a,...c}){return(0,b.jsx)(q.Title,{"data-slot":"sheet-title",className:(0,s.cn)("text-foreground font-semibold",a),...c})}function B({className:a,...c}){return(0,b.jsx)(q.Description,{"data-slot":"sheet-description",className:(0,s.cn)("text-muted-foreground text-sm",a),...c})}var C=a.i(54816),D=a.i(15618),E=a.i(4720),F=a.i(92e3),G=a.i(21161),H=a.i(60246),I=a.i(63588),J=a.i(3314),K=a.i(53722),L=a.i(67453),M=a.i(2835),N=a.i(84581),O=a.i(70106);let P=(0,O.default)("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);var Q=a.i(37776),R=a.i(77156);let S=(0,O.default)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var T=a.i(23292),U=a.i(46470);let V={text:"Krátký text",textarea:"Dlouhý text",number:"Číslo",checkbox:"Zaškrtávací pole",url:"URL odkaz",select:"Výběr z možností"},W={basic:{label:"Základní informace",icon:H.Users,description:"Jméno, věk, Discord..."},motivation:{label:"Motivace",icon:I.MessageSquare,description:"Proč u nás chcete hrát?"},roleplay:{label:"Roleplay",icon:K.BookOpen,description:"Pojmy, zkušenosti..."},rules_basic:{label:"Základní pravidla",icon:J.Shield,description:"Nejčastější prohřešky."},rules_advanced:{label:"Pokročilá pravidla",icon:G.Settings,description:"Komplexnější pravidla."},specific_rules:{label:"Specifická pravidla",icon:L.CheckCircle2,description:"Pravidla pro frakce, gangy."},scenarios:{label:"Herní scénáře",icon:E.FileText,description:"Jak bys řešil situaci X?"},agreement:{label:"Souhlasy",icon:L.CheckCircle2,description:"Souhlas se zpracováním údajů."},general:{label:"Obecné",icon:M.Hash,description:"Nezařazené otázky."}},X={question:"",field_name:"",field_type:"text",placeholder:"",required:!0,category:"general",is_active:!0},Y=({question:a,handleEdit:c,handleDelete:d,handleToggleActive:e})=>{let{attributes:f,listeners:i,setNodeRef:k,transform:l,transition:n}=(0,g.useSortable)({id:a.id}),o={transform:h.CSS.Transform.toString(l),transition:n};return(0,b.jsxs)("div",{ref:k,style:o,className:(0,s.cn)("flex items-center bg-zinc-900/50 border border-zinc-800 rounded-lg p-3 pr-4 shadow-sm transition-all duration-200",!a.is_active&&"bg-zinc-950/50 border-zinc-900 opacity-60"),children:[(0,b.jsx)("div",{...f,...i,className:"p-2 cursor-grab text-zinc-500 hover:text-white transition-colors",children:(0,b.jsx)(N.GripVertical,{className:"h-5 w-5"})}),(0,b.jsxs)("div",{className:"flex-grow ml-2",children:[(0,b.jsx)("p",{className:"font-medium text-zinc-100",children:a.question}),(0,b.jsxs)("div",{className:"flex items-center gap-3 text-xs text-zinc-400 mt-1",children:[(0,b.jsx)(m.Badge,{variant:"outline",className:"text-xs",children:V[a.field_type]}),a.required&&(0,b.jsx)(m.Badge,{variant:"destructive",className:"bg-red-500/10 text-red-400 border-none",children:"Povinné"})]})]}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsxs)(C.TooltipProvider,{children:[(0,b.jsxs)(C.Tooltip,{children:[(0,b.jsx)(C.TooltipTrigger,{asChild:!0,children:(0,b.jsx)(j.Button,{variant:"ghost",size:"icon",onClick:()=>e(a),children:a.is_active?(0,b.jsx)(R.Eye,{className:"h-4 w-4"}):(0,b.jsx)(S,{className:"h-4 w-4"})})}),(0,b.jsx)(C.TooltipContent,{children:(0,b.jsx)("p",{children:a.is_active?"Skrýt otázku":"Zobrazit otázku"})})]}),(0,b.jsxs)(C.Tooltip,{children:[(0,b.jsx)(C.TooltipTrigger,{asChild:!0,children:(0,b.jsx)(j.Button,{variant:"ghost",size:"icon",onClick:()=>c(a),children:(0,b.jsx)(P,{className:"h-4 w-4"})})}),(0,b.jsx)(C.TooltipContent,{children:(0,b.jsx)("p",{children:"Upravit otázku"})})]}),(0,b.jsxs)(C.Tooltip,{children:[(0,b.jsx)(C.TooltipTrigger,{asChild:!0,children:(0,b.jsx)(j.Button,{variant:"ghost",size:"icon",className:"text-red-500 hover:text-red-400",onClick:()=>d(a.id),children:(0,b.jsx)(Q.Trash2,{className:"h-4 w-4"})})}),(0,b.jsx)(C.TooltipContent,{children:(0,b.jsx)("p",{children:"Smazat otázku"})})]})]})})]})};function Z(){let[a,h]=(0,c.useState)([]),[m,q]=(0,c.useState)(!0),[r,v]=(0,c.useState)("basic"),[w,G]=(0,c.useState)(null),[H,I]=(0,c.useState)(X),[J,K]=(0,c.useState)(!1),[L,M]=(0,c.useState)(!1),N=(0,f.useSensors)((0,f.useSensor)(f.PointerSensor));(0,c.useEffect)(()=>{O()},[]);let O=async()=>{q(!0);try{let a=await fetch("/api/admin/whitelist-questions");if(!a.ok)throw Error("Failed to fetch questions");let b=await a.json();h(b.questions||[])}catch(a){T.toast.error("Chyba při načítání otázek")}finally{q(!1)}},P=async()=>{if(!H.question||!H.field_name||!H.field_type)return void T.toast.error("Vyplňte všechna povinná pole: Otázka, Název pole, Typ pole.");M(!0);try{let b=w?`/api/admin/whitelist-questions/${w.id}`:"/api/admin/whitelist-questions",c=w?"PUT":"POST",d={...H,order_index:w?.order_index??a.filter(a=>a.category===H.category).length},e=await fetch(b,{method:c,headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});if(!e.ok){let a=await e.text();throw Error(a||"Failed to save question")}T.toast.success(w?"Otázka byla aktualizována":"Otázka byla vytvořena"),await O(),K(!1)}catch(a){T.toast.error(`Chyba při ukl\xe1d\xe1n\xed: ${a.message}`)}finally{M(!1)}},Q=async b=>{let c=a.find(a=>a.id===b);if(c&&confirm(`Opravdu chcete smazat ot\xe1zku "${c.question}"?`))try{let a=await fetch(`/api/admin/whitelist-questions/${b}`,{method:"DELETE"});if(!a.ok){let b=await a.text();throw Error(b||"Failed to delete question")}T.toast.success("Otázka byla smazána"),await O()}catch(a){T.toast.error(`Chyba při maz\xe1n\xed: ${a.message}`)}},R=async a=>{try{let b=await fetch(`/api/admin/whitelist-questions/${a.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...a,is_active:!a.is_active})});if(!b.ok){let a=await b.text();throw Error(a||"Failed to toggle question")}T.toast.success(`Ot\xe1zka byla ${!a.is_active?"zobrazena":"skryta"}.`),await O()}catch(a){T.toast.error(`Chyba při změně viditelnosti: ${a.message}`)}},S=a=>{G(a),I(a),K(!0)},Z=async b=>{let{active:c,over:d}=b,e=a.filter(a=>a.category===r).sort((a,b)=>a.order_index-b.order_index);if(c.id!==d?.id){let b=e.findIndex(a=>a.id===c.id),f=e.findIndex(a=>a.id===d.id),i=(0,g.arrayMove)(e,b,f);h(a.map(a=>{if(i.find(b=>b.id===a.id)){let b=i.findIndex(b=>b.id===a.id);return{...a,order_index:b}}return a}));let j=i.map((a,b)=>({id:a.id,order_index:b}));try{if(!(await fetch("/api/admin/whitelist-questions",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({updates:j})})).ok)throw Error("Failed to update order");T.toast.success("Pořadí otázek bylo aktualizováno."),await O()}catch(a){T.toast.error("Nepodařilo se uložit nové pořadí."),await O()}}},$=(0,c.useMemo)(()=>a.filter(a=>a.category===r).sort((a,b)=>a.order_index-b.order_index),[a,r]);return(0,b.jsxs)("div",{className:"flex gap-10 min-h-[calc(100vh-8rem)]",children:[(0,b.jsxs)("aside",{className:"w-64 flex-shrink-0",children:[(0,b.jsxs)("div",{className:"p-3 rounded-xl bg-gradient-to-br from-[#b90505]/20 to-[#bd2727]/10 text-[#bd2727] border border-[#b90505]/30 shadow-lg mb-6 flex items-center gap-4",children:[(0,b.jsx)(E.FileText,{className:"h-8 w-8"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold bg-gradient-to-r from-white to-gray-300 bg-clip-text text-transparent",children:"Whitelist"}),(0,b.jsx)("p",{className:"text-sm text-gray-400",children:"Správa otázek"})]})]}),(0,b.jsx)("nav",{className:"flex flex-col gap-1",children:Object.entries(W).map(([c,{label:d,icon:e,description:f}])=>(0,b.jsx)(C.TooltipProvider,{delayDuration:100,children:(0,b.jsxs)(C.Tooltip,{children:[(0,b.jsx)(C.TooltipTrigger,{asChild:!0,children:(0,b.jsxs)("button",{onClick:()=>v(c),className:(0,s.cn)("flex items-center gap-3 w-full text-left px-3 py-2.5 rounded-md text-sm font-medium transition-colors duration-200",r===c?"bg-zinc-800 text-white shadow-inner":"text-zinc-400 hover:bg-zinc-800/50 hover:text-zinc-200"),children:[(0,b.jsx)(e,{className:"h-5 w-5 flex-shrink-0"}),(0,b.jsx)("span",{children:d}),(0,b.jsx)("span",{className:"ml-auto text-xs font-mono px-1.5 py-0.5 rounded-sm bg-zinc-700/50",children:a.filter(a=>a.category===c).length})]})}),(0,b.jsx)(C.TooltipContent,{side:"right",children:(0,b.jsx)("p",{children:f})})]})},c))})]}),(0,b.jsxs)("main",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-3xl font-bold text-white",children:W[r]?.label||"Všechny otázky"}),(0,b.jsx)("p",{className:"text-zinc-400 mt-1",children:W[r]?.description||"Správa všech otázek ve formuláři."})]}),(0,b.jsxs)(j.Button,{onClick:()=>{G(null),I({...X,category:r}),K(!0)},className:"bg-[#b90505] hover:bg-[#8a0101]",children:[(0,b.jsx)(D.Plus,{className:"mr-2 h-4 w-4"}),"Přidat novou otázku"]})]}),m?(0,b.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,b.jsx)("div",{className:"w-8 h-8 border-4 border-[#b90505] border-t-transparent rounded-full animate-spin"})}):$.length>0?(0,b.jsx)(f.DndContext,{sensors:N,collisionDetection:f.closestCenter,onDragEnd:Z,modifiers:[i.restrictToVerticalAxis,i.restrictToWindowEdges],children:(0,b.jsx)(g.SortableContext,{items:$.map(a=>a.id),strategy:g.verticalListSortingStrategy,children:(0,b.jsx)("div",{className:"space-y-3",children:$.map(a=>(0,b.jsx)(Y,{question:a,handleEdit:S,handleDelete:Q,handleToggleActive:R},a.id))})})}):(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center text-center bg-zinc-900/50 border-2 border-dashed border-zinc-800 rounded-xl py-20",children:[(0,b.jsx)(F.AlertCircle,{className:"h-12 w-12 text-zinc-600 mb-4"}),(0,b.jsx)("h3",{className:"text-xl font-semibold text-white",children:"Žádné otázky v této kategorii"}),(0,b.jsx)("p",{className:"text-zinc-400 mt-2 max-w-sm",children:`Pro kategorii "${W[r]?.label}" zat\xedm nebyly vytvořeny ž\xe1dn\xe9 ot\xe1zky. Můžete je přidat kliknut\xedm na tlač\xedtko vpravo nahoře.`})]})]}),(0,b.jsx)(t,{open:J,onOpenChange:K,children:(0,b.jsxs)(x,{className:"bg-zinc-950 border-zinc-800 text-zinc-50 sm:max-w-lg",children:[(0,b.jsxs)(U.ScrollArea,{className:"h-full pr-6 -mr-6",children:[(0,b.jsxs)(y,{className:"mb-6",children:[(0,b.jsx)(A,{className:"text-2xl text-white",children:w?"Upravit otázku":"Vytvořit novou otázku"}),(0,b.jsx)(B,{children:"Pečlivě vyplňte všechny detaily. Změny se projeví ve formuláři pro žadatele o whitelist."})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-4 p-4 rounded-lg border border-zinc-800 bg-zinc-900",children:[(0,b.jsx)("h4",{className:"font-semibold text-lg text-white",children:"Základní nastavení"}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{htmlFor:"question",children:"Text otázky"}),(0,b.jsx)(p.Textarea,{id:"question",value:H.question||"",onChange:a=>I({...H,question:a.target.value}),className:"mt-1",required:!0})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{htmlFor:"category",children:"Kategorie"}),(0,b.jsxs)(n.Select,{value:H.category,onValueChange:a=>I({...H,category:a}),children:[(0,b.jsx)(n.SelectTrigger,{id:"category",className:"mt-1",children:(0,b.jsx)(n.SelectValue,{placeholder:"Vyberte kategorii"})}),(0,b.jsx)(n.SelectContent,{children:Object.entries(W).map(([a,{label:c}])=>(0,b.jsx)(n.SelectItem,{value:a,children:c},a))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{htmlFor:"field_type",children:"Typ pole"}),(0,b.jsxs)(n.Select,{value:H.field_type,onValueChange:a=>I({...H,field_type:a}),children:[(0,b.jsx)(n.SelectTrigger,{id:"field_type",className:"mt-1",children:(0,b.jsx)(n.SelectValue,{placeholder:"Vyberte typ pole"})}),(0,b.jsx)(n.SelectContent,{children:Object.entries(V).map(([a,c])=>(0,b.jsx)(n.SelectItem,{value:a,children:c},a))})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{htmlFor:"field_name",children:"Unikátní název pole (bez diakritiky a mezer)"}),(0,b.jsx)(k.Input,{id:"field_name",value:H.field_name||"",onChange:a=>I({...H,field_name:a.target.value.toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,"")}),className:"mt-1 font-mono",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{htmlFor:"placeholder",children:"Placeholder (nápověda v poli)"}),(0,b.jsx)(k.Input,{id:"placeholder",value:H.placeholder||"",onChange:a=>I({...H,placeholder:a.target.value}),className:"mt-1"})]})]}),(0,b.jsx)(e.AnimatePresence,{children:("number"===H.field_type||"text"===H.field_type||"textarea"===H.field_type||"select"===H.field_type)&&(0,b.jsxs)(d.motion.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-4 p-4 rounded-lg border border-zinc-800 bg-zinc-900 overflow-hidden",children:[(0,b.jsx)("h4",{className:"font-semibold text-lg text-white",children:"Specifická nastavení pole"}),"number"===H.field_type&&(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{htmlFor:"min_value",children:"Minimální hodnota"}),(0,b.jsx)(k.Input,{id:"min_value",type:"number",value:H.min_value??"",onChange:a=>I({...H,min_value:""===a.target.value?void 0:Number(a.target.value)}),className:"mt-1"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{htmlFor:"max_value",children:"Maximální hodnota"}),(0,b.jsx)(k.Input,{id:"max_value",type:"number",value:H.max_value??"",onChange:a=>I({...H,max_value:""===a.target.value?void 0:Number(a.target.value)}),className:"mt-1"})]})]}),("text"===H.field_type||"textarea"===H.field_type)&&(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{htmlFor:"min_length",children:"Minimální délka"}),(0,b.jsx)(k.Input,{id:"min_length",type:"number",value:H.min_length??"",onChange:a=>I({...H,min_length:""===a.target.value?void 0:Number(a.target.value)}),className:"mt-1"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{htmlFor:"max_length",children:"Maximální délka"}),(0,b.jsx)(k.Input,{id:"max_length",type:"number",value:H.max_length??"",onChange:a=>I({...H,max_length:""===a.target.value?void 0:Number(a.target.value)}),className:"mt-1"})]})]}),"select"===H.field_type&&(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{htmlFor:"options",children:"Možnosti (každá na nový řádek)"}),(0,b.jsx)(p.Textarea,{id:"options",value:H.options?.join("\n")||"",onChange:a=>I({...H,options:a.target.value.split("\n")}),className:"mt-1 font-mono",rows:4})]})]})}),(0,b.jsxs)("div",{className:"space-y-4 p-4 rounded-lg border border-zinc-800 bg-zinc-900",children:[(0,b.jsx)("h4",{className:"font-semibold text-lg text-white",children:"Atributy"}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(o.Checkbox,{id:"required",checked:H.required,onCheckedChange:a=>I({...H,required:!!a})}),(0,b.jsx)(l.Label,{htmlFor:"required",children:"Povinná otázka"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(o.Checkbox,{id:"is_active",checked:H.is_active,onCheckedChange:a=>I({...H,is_active:!!a})}),(0,b.jsx)(l.Label,{htmlFor:"is_active",children:"Aktivní (zobrazit ve formuláři)"})]})]})]})]}),(0,b.jsxs)(z,{className:"mt-6 pt-4 border-t border-zinc-800",children:[(0,b.jsx)(u,{asChild:!0,children:(0,b.jsx)(j.Button,{variant:"outline",children:"Zrušit"})}),(0,b.jsx)(j.Button,{onClick:P,disabled:L,children:L?"Ukládání...":"Uložit otázku"})]})]})})]})}a.s(["default",()=>Z],35114)}];

//# sourceMappingURL=app_admin_whitelist-questions_page_tsx_78b69fa0._.js.map